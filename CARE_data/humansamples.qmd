---
title: "Untitled"
format: html
---

```SQL
ALTER TABLE ndb.isospecimendata
DROP CONSTRAINT fk_isospecimendata_specimens,
ADD CONSTRAINT fk_isospecimendata_specimens
   FOREIGN KEY (specimenid)
   REFERENCES ndb.specimens(specimenid)
   ON DELETE CASCADE;

WITH dropdata AS (
SELECT dsdb.datasetid, 
    cdb.databasename,
    dt.dataid,
    smp.sampleid
FROM ndb.taxa AS tx
INNER JOIN ndb.variables AS var ON var.taxonid = tx.taxonid
INNER JOIN ndb.data AS dt ON dt.variableid = var.variableid
INNER JOIN ndb.samples AS smp ON smp.sampleid = dt.sampleid
INNER JOIN ndb.datasetdatabases AS dsdb ON smp.datasetid = dsdb.datasetid
INNER JOIN ndb.datasets AS ds ON ds.datasetid = dsdb.datasetid
INNER JOIN ndb.constituentdatabases AS cdb ON cdb.databaseid = dsdb.databaseid
INNER JOIN ndb.collectionunits AS cu ON ds.collectionunitid = cu.collectionunitid
WHERE tx.taxonname ILIKE 'homo sapiens%' AND cu.siteid = ANY(ARRAY[5295,4895,5160,3606,3814,4348,5484,23721,6128,3831,3958,5647,4364,3636,5470,3962,5669,3921,5681,4462,6147,4740,5644,4694,5494,5902,3835,5153,6198,4996,3868,4458,29426,4147,5285,5684,16264,4696,5894,5092,5240,4520,4478,5632,29436,6194,29434,4145,6230,5097,5116,5551,6469,5538,29421,4003,9950,5532,6195,4465,6281,4206,3602,6185,5898,5752,5682,6199,6287,6262,6088,4368,4417,3852,3830,5074,5904,4227,5297,6374,4698,4467,4865,5522,29447,6245,23619,4378,3859,4570,16316,6048,5516,4115,4002,3651,4287,4999,5756,4867,4599,5062,5635,3685,4988,3603,4349,3605,29437,6446,5048,3749,5520,5631,5691,29461,4372,5854,6187,4211,4374,4516,6241,4345,29419,4746,6114,6275,5654,4992,23112,4365,5897,5406,27213,4361,16664,6283,4709,5932,5889,4888,22649,4366,5490,5286,5492,5030,29442,4281,5511,6284,5473,6105,5777,6300,5064,23536,5147,4391,5503,5875,4375,5504,5675,5806,3942,4138,4394,4523,22543,3880,4217,4452,29435,3809,4284,6457,4161,5063,6150,10534,18148,5284,3811,6382,14328,29418,29439,5469,4218,4515,5493,5501,5657,5213,5780,14411,5710,6113,6186,4891,5890,16869,5139,5885,3871,16512,4578,5523,5900,6089,6106,5115,5462,16308,29417,5114,29420,6091,5517,6401,4484,5519,5843,6456,4204,4519,4380,4432,6314,5495,4050,6141,6192,29454,29456,5660,6172,5206,14427,4329,5119,6115,6369,4926,5338,6193,23730,6307,29453,4379,3819,5878,4446,4481,29423,3723,6090,6127,6243,5903,4477,6109,16157,22653,5515,3863,5772,6097,29462,3998,16585,4269,4358,5746,4524,5149,5417,16555,3812,6191,16505,5491,5448,5055,5100,5293,4216,29452,6146,3670,5692,6298,3681,4382,5852,5508,5697,23419,5496,5376,29427,5705,5541,6145,5645,6196,3870,6197,6472,29406,5544,29441,5131,6395,23406,29416,4118,4387,5228,3724,4350,5479,6104,29449,5204,6092,6083,3854,6377,5489,5281,6288,5923,5865,4385,29404,5701,29414,3892,5485,4862,5690,16723,6180,5727,5497,6282,6376,5893,4347,29428,29407,5461,4125,6149,5123,6121,4202,4214,5550,4057,4377,5892,4330,6093,4444,5521,4254,4708,29444,4487,5282,4912,4205,29422,5679,5510,3546,5667,5081])
ORDER BY cdb.databasename)
DELETE FROM ndb.data WHERE dataid = ANY(SELECT dataid FROM dropdata);
```